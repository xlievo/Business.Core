
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>APIs Documents</title>
    <link rel="shortcut icon" href="/doc2/w9.ico" />

    <link rel="stylesheet" type="text/css" href="/doc2/bootstrap-3.3.7/css/bootstrap.min.css">
    <!-- JSON Schema Based Editor -->
    <script src="/doc2/jsoneditor/jsoneditor.min.js"></script>
    <!-- Collapse -->
    <link rel="stylesheet" type="text/css" href="/doc2/houdini/css/houdini.min.css">
    <script src="/doc2/houdini/js/houdini.polyfills.min.js"></script>
    <!-- Ajax request -->
    <script src="/doc2/atomic/atomic.polyfills.min.js"></script>
    <!-- Ajax.org Cloud9 Editor -->
    <script src="/doc2/ace/ace.js"></script>
    <!-- juicer -->
    <script type="text/javascript" src="/doc2/Juicer/juicer-min.js"></script>
    <!-- DOMPurify -->
    <script type="text/javascript" src="/doc2/DOMPurify/purify.min.js"></script>

    <style type="text/css">
    </style>

    <script>
        //const choices = new Choices("choices-single-no-search");
        // Set the default CSS theme and icon library globally
        JSONEditor.defaults.theme = 'bootstrap3';
        JSONEditor.defaults.iconlib = 'bootstrap3';
        JSONEditor.defaults.options.disable_properties = true;
        JSONEditor.defaults.options.required_by_default = true;
        JSONEditor.defaults.options.disable_edit_json = true;
        //JSONEditor.defaults.options.disable_collapse = true;

        var Theme = JSONEditor.defaults.themes.bootstrap3;
        JSONEditor.defaults.themes.bootstrap3 = function () {
            var theme = new Theme();

            theme.getGridRow = function () {
                var el = document.createElement('div');
                el.classList.add('row');
                el.style.paddingTop = el.style.paddingBottom = el.style.marginTop = el.style.marginBottom = '0px';
                el.style.marginTop = '8px';
                el.style.marginBottom = '8px';
                return el;
            };

            theme.getHeader = function (text) {
                var el = document.createElement('h4');
                el.style.paddingTop = el.style.paddingBottom = el.style.marginTop = el.style.marginBottom = '0px';
                //el.style.marginTop = '0px';
                //el.style.marginBottom = '0px';
                //el.style.marginTop = '0px';
                //el.style.marginBottom = '5px';
                el.setAttribute('tag', 'h4');
                if (typeof text === "string") {
                    el.textContent = text;
                }
                else {
                    el.appendChild(text);
                }
                return el;
            };

            theme.getFormControl = function (label, input, description, infoText) {
                var group = document.createElement('div');
                group.style.paddingTop = group.style.paddingBottom = group.style.marginTop = group.style.marginBottom = '0px';

                if (label && input.type === 'checkbox') {
                    group.classList.add('checkbox');
                    label.appendChild(input);
                    label.style.fontSize = '14px';
                    if (infoText) group.appendChild(infoText);
                    group.appendChild(label);
                    input.style.position = 'relative';
                    input.style.cssFloat = 'left';
                }
                else {
                    group.classList.add('form-group');
                    if (label) {
                        label.classList.add('control-label');
                        group.appendChild(label);
                        //group.style.marginBottom = '10px';
                    }

                    if (infoText) group.appendChild(infoText);
                    group.appendChild(input);
                }

                if (description) {
                    //description.style.marginTop = '0px';
                    //description.style.marginBottom = '0px';
                    //description.setAttribute('tag', 'description');
                    group.appendChild(description);
                }

                return group;
            };

            theme.getIndentedPanel = function () {
                var el = document.createElement('div');
                el.classList.add('well', 'well-sm');
                el.style.paddingTop = el.style.paddingBottom = el.style.marginTop = el.style.marginBottom = '0px';
                el.style.marginTop = '8px';
                //el.style.paddingBottom = '6px';
                //el.style.paddingTop = '18px';
                //el.style.marginTop = '9px';
                //el.style.marginBottom = '12px';
                el.setAttribute('tag', 'panel');
                return el;
            };

            theme.getSelectInput = function (options) {
                var select = document.createElement('select');
                if (options) this.setSelectOptions(select, options);
                select.classList.add('form-control');
                select.setAttribute('tag', 'input');
                return select;
            };

            theme.getTextareaInput = function () {
                var el = document.createElement('textarea');
                el.classList.add('form-control');
                el.setAttribute('tag', 'input');
                return el;
            };

            theme.getFormInputField = function (type) {
                var el = document.createElement('input');
                el.setAttribute('type', type);
                el.setAttribute('tag', 'input');
                if (type !== "checkbox") {
                    el.classList.add("form-control");
                }
                return el;
            };

            theme.getDescription = function (text) {
                var el = document.createElement('p');
                el.style.paddingTop = el.style.paddingBottom = el.style.marginTop = el.style.marginBottom = '0px';
                el.style.marginTop = '6px';
                el.setAttribute('tag', 'description');
                if (window.DOMPurify) el.innerHTML = window.DOMPurify.sanitize(text);
                else el.textContent = this.cleanText(text);
                return el;
            };

            theme.getFormInputDescription = function (text) {
                var el = document.createElement('p');
                el.style.paddingTop = el.style.paddingBottom = el.style.marginTop = el.style.marginBottom = '0px';
                el.setAttribute('tag', 'description');
                el.classList.add('help-block');
                if (window.DOMPurify) el.innerHTML = window.DOMPurify.sanitize(text);
                else el.textContent = this.cleanText(text);
                return el;
            };

            return theme
        };

        JSONEditor.defaults.editors.array = JSONEditor.defaults.editors.array.extend({
            addControls: function () {
                var self = this;

                this.collapsed = false;
                this.toggle_button = this.getButton('', 'collapse', this.translate('button_collapse'));
                this.toggle_button.setAttribute('tag', 'toggle');
                this.toggle_button.setAttribute('collapsed', this.collapsed);
                this.toggle_button.classList.add('json-editor-btntype-toggle');
                this.title_controls.appendChild(this.toggle_button);
                var row_holder_display = self.row_holder.style.display;
                var controls_display = self.controls.style.display;
                this.toggle_button.addEventListener('click', function (e) {
                    e.preventDefault();
                    e.stopPropagation();
                    if (self.collapsed) {
                        self.collapsed = false;
                        if (self.panel) self.panel.style.display = '';
                        self.row_holder.style.display = row_holder_display;
                        if (self.tabs_holder) self.tabs_holder.style.display = '';
                        self.controls.style.display = controls_display;
                        self.setButtonText(this, '', 'collapse', self.translate('button_collapse'));
                    }
                    else {
                        self.collapsed = true;
                        self.row_holder.style.display = 'none';
                        if (self.tabs_holder) self.tabs_holder.style.display = 'none';
                        self.controls.style.display = 'none';
                        if (self.panel) self.panel.style.display = 'none';
                        self.setButtonText(this, '', 'expand', self.translate('button_expand'));
                    }
                    self.toggle_button.setAttribute('collapsed', self.collapsed);
                });

                // If it should start collapsed
                if (this.options.collapsed) {
                    $trigger(this.toggle_button, 'click');
                }

                // Collapse button disabled
                if (this.schema.options && typeof this.schema.options.disable_collapse !== "undefined") {
                    if (this.schema.options.disable_collapse) this.toggle_button.style.display = 'none';
                }
                else if (this.jsoneditor.options.disable_collapse) {
                    this.toggle_button.style.display = 'none';
                }

                // Add "new row" and "delete last" buttons below editor
                this.add_row_button = this.getButton(this.getItemTitle(), 'add', this.translate('button_add_row_title', [this.getItemTitle()]));
                this.add_row_button.classList.add('json-editor-btntype-add');
                this.add_row_button.addEventListener('click', function (e) {
                    e.preventDefault();
                    e.stopPropagation();
                    var i = self.rows.length;
                    if (self.row_cache[i]) {
                        self.rows[i] = self.row_cache[i];
                        self.rows[i].setValue(self.rows[i].getDefault(), true);
                        self.rows[i].container.style.display = '';
                        if (self.rows[i].tab) self.rows[i].tab.style.display = '';
                        self.rows[i].register();
                    }
                    else {
                        self.addRow();
                    }
                    self.active_tab = self.rows[i].tab;
                    self.refreshTabs();
                    self.refreshValue();
                    self.onChange(true);
                    self.jsoneditor.trigger('addRow');
                });
                self.controls.appendChild(this.add_row_button);

                this.delete_last_row_button = this.getButton(this.translate('button_delete_last', [this.getItemTitle()]), 'delete', this.translate('button_delete_last_title', [this.getItemTitle()]));
                this.delete_last_row_button.classList.add('json-editor-btntype-deletelast');
                this.delete_last_row_button.addEventListener('click', function (e) {
                    e.preventDefault();
                    e.stopPropagation();

                    if (!self.askConfirmation()) {
                        return false;
                    }

                    var rows = self.getValue();
                    var new_active_tab = null;

                    rows.pop();
                    self.empty(true);
                    self.setValue(rows);

                    if (self.rows[self.rows.length - 1]) {
                        new_active_tab = self.rows[self.rows.length - 1].tab;
                    }

                    if (new_active_tab) {
                        self.active_tab = new_active_tab;
                        self.refreshTabs();
                    }

                    self.onChange(true);
                    self.jsoneditor.trigger('deleteRow');
                });
                self.controls.appendChild(this.delete_last_row_button);

                this.remove_all_rows_button = this.getButton(this.translate('button_delete_all'), 'delete', this.translate('button_delete_all_title'));
                this.remove_all_rows_button.classList.add('json-editor-btntype-deleteall');
                this.remove_all_rows_button.addEventListener('click', function (e) {
                    e.preventDefault();
                    e.stopPropagation();

                    if (!self.askConfirmation()) {
                        return false;
                    }

                    self.empty(true);
                    self.setValue([]);
                    self.onChange(true);
                    self.jsoneditor.trigger('deleteAllRows');
                });
                self.controls.appendChild(this.remove_all_rows_button);

                if (self.tabs) {
                    this.add_row_button.style.width = '100%';
                    this.add_row_button.style.textAlign = 'left';
                    this.add_row_button.style.marginBottom = '3px';

                    this.delete_last_row_button.style.width = '100%';
                    this.delete_last_row_button.style.textAlign = 'left';
                    this.delete_last_row_button.style.marginBottom = '3px';

                    this.remove_all_rows_button.style.width = '100%';
                    this.remove_all_rows_button.style.textAlign = 'left';
                    this.remove_all_rows_button.style.marginBottom = '3px';
                }
            }
        });

        var Iconlibs = JSONEditor.defaults.iconlibs.bootstrap3;
        JSONEditor.defaults.iconlibs.bootstrap3 = function () {
            var icon = new Iconlibs();
            icon.mapping = {
                collapse: 'chevron-down',
                expand: 'chevron-right',
                "delete": 'remove',
                edit: 'edit',
                add: 'plus',
                cancel: 'floppy-remove',
                save: 'floppy-saved',
                moveup: 'arrow-up',
                movedown: 'arrow-down',
                clear: 'remove-circle',
                time: 'time',
                calendar: 'calendar',
                data: 'list-alt'
            };

            return icon;
        };

    </script>
</head>
<body>

    <div class='container'>


        <!--<div class='medium-12-columns'>
            <button id='submit' class='tiny'>Submit (console.log)</button>
            <button id='restore' class='secondary tiny'>Restore to Default</button>
            <span id='valid_indicator' class='label'></span>
        </div>

        <div class="row">
            <div class="col-md-6 col-md-offset-3"
                 style="background-color: #dedef8;box-shadow:
         inset 1px -1px 1px #444, inset -1px 1px 1px #444;">
                <p>
                    Lorem ipsum dolor sit amet, consectetur adipisicing
                    elit.
                </p>
            </div>

        </div>-->

        <div class="input-group input-group-lg" style="padding-top: 20px;
        padding-bottom: 20px;">

            <input type="text" class="form-control">
            <div class="input-group-btn">
                <button class="btn btn-default" type="button">
                    Go!
                </button>
                <select class="btn btn-default dropdown-toggle">
                    <option value="Five">ss</option>
                    <option value="Five" selected="selected">33 </option>
                    <option value="Five">j</option>
                </select>

            </div>
        </div><!-- /input-group -->
        <!-- ============================= -->
        <div class="panel-group" id="members" />
        <!-- ============================= -->
    </div>

    <script id="tpl" type="text/template">
        {@each _ as member}
        <div class="panel panel-info">
            <div class="panel-heading">
                <h4>
                    <span class="d-inline-block">${member.name}</span>
                    <span class="pull-right">
                        <a data-houdini-toggle="${member.name}_member">Detailed description</a>
                    </span>
                </h4>
                {@if member.description !== null && member.description !== 'null'}
                <hr>
                <p class="mb-0">${member.description}</p>
                {@/if}
            </div>
            <div data-houdini id='${member.name}_member' style="padding: 10px">
                <div id='${member.name}_input' style="padding-top: 0px;"></div>
                <!--<div id='${member.name}_input' style="padding-top: 10px;"></div>-->
                <!--<div id='${member.name}_out' style="padding-top: 10px;"></div>-->
                <div id='${member.name}_sdk' style="padding-top: 10px;"></div>
            </div>
        </div>
        {@/each}
    </script>

    <script>

        //const choices = new Choices("select");
        var $trigger = function (el, event) {
            var e = document.createEvent('HTMLEvents');
            e.initEvent(event, true, true);
            el.dispatchEvent(e);
        };

        var edit = false;

        atomic("http://localhost:5000/API.doc")
            .then(function (response) {
                console.log(response.data); // xhr.responseText
                //console.log(response.xhr);  // full response
                var doc = response.data;

                var members = doc.members["j"];
                var members2 = []
                for (var i in members) {
                    members2.push(members[i]);
                }

                var tpl = document.getElementById('tpl').innerHTML;
                var html = juicer(tpl, members2);
                document.getElementById('members').innerHTML = html;

                //=============================================//
                members2.forEach(member => {
                    //==================input==================//
                    var inputid = member.name + '_input';

                    var input = {
                        title: "Input",
                        type: "object",
                        edit: !edit,
                        properties: {
                            t: {
                                id: member.name + '.t',
                                title: "t (String)",
                                type: "string",
                                description: "API token",
                                options: {
                                    inputAttributes: {
                                        placeholder: "API token"
                                    }
                                }
                            },
                            d: {
                                id: member.name + '.d',
                                title: "d (JsonArray)",
                                type: "object",
                                description: "API data",
                                properties: {}
                            }
                        }
                    };

                    var token = false;
                    for (var i in member.properties) {
                        if (member.properties[i].token) {
                            token = true;
                        } else {
                            input.properties.d.properties[i] = member.properties[i];
                        }
                    }

                    if (!token) {
                        delete input.properties.t;
                    }

                    var inputeditor = new JSONEditor(document.getElementById(inputid), {
                        // The schema for the editor
                        schema: input
                    });

                    ready(inputeditor);
                    //========================================//

                    //==================sdk==================//
                    var outid = member.name + '_out';
                    var sdkid = member.name + '_sdk';
                    new JSONEditor(document.getElementById(sdkid), {
                        // Enable fetching schemas via ajax
                        //ajax: true,
                        schema: {
                            title: "SDK",
                            type: "object",
                            format: "categories",
                            properties: {
                                NET: getSdk("json"),
                                Java: getSdk("java"),
                                PHP: getSdk("php")
                            }
                        }

                        // Seed the form with a starting value
                        , startval: {
                            "NET": {
                                "value": "{\n  \"type\": \"string\",\n  \"format\": \"json\",\n  \"options\": {\n    \"ace\": {\n      \"theme\": \"ace/theme/vibrant_ink\",\n      \"tabSize\": 2,\n      \"useSoftTabs\": true,\n      \"wrap\": true,\n      \"readOnly\": true,\n      \"newLineMode\": \"windows\"\n    }\n  }\n}"
                            },
                            "Java": {
                                "value": "{\n  \"type\": \"string\",\n  \"format\": \"json\",\n  \"options\": {\n    \"ace\": {\n      \"theme\": \"ace/theme/vibrant_ink\",\n      \"tabSize\": 2,\n      \"useSoftTabs\": true,\n      \"wrap\": true,\n      \"readOnly\": true,\n      \"newLineMode\": \"windows\"\n    }\n  }\n}"
                            },
                            "PHP": {
                                "value": "{\n  \"type\": \"string\",\n  \"format\": \"json\",\n  \"options\": {\n    \"ace\": {\n      \"theme\": \"ace/theme/vibrant_ink\",\n      \"tabSize\": 2,\n      \"useSoftTabs\": true,\n      \"wrap\": true,\n      \"readOnly\": true,\n      \"newLineMode\": \"windows\"\n    }\n  }\n}"
                            }
                        }
                    });

                    document.querySelector('#' + sdkid + ' > div > div.well.well-sm > div > div').style.cssText = 'padding: 0px;border: 0px;margin: 0px;';
                    //========================================//
                });

                //set all edit
                setEdit(document, edit);

                document.querySelectorAll('#NET > div > div > h4').forEach(c => c.style.display = 'none');
                document.querySelectorAll('#Java > div > div > h4').forEach(c => c.style.display = 'none');
                document.querySelectorAll('#PHP > div > div > h4').forEach(c => c.style.display = 'none');
                document.querySelectorAll('#NET > div > div > div.well.well-sm > div > div > div > div > div.form-group > label').forEach(c => c.style.display = 'none');
                document.querySelectorAll('#Java > div > div > div.well.well-sm > div > div > div > div > div.form-group > label').forEach(c => c.style.display = 'none');
                document.querySelectorAll('#PHP > div > div > div.well.well-sm > div > div > div > div > div.form-group > label').forEach(c => c.style.display = 'none');

                new Houdini('[data-houdini]');
            })
            .catch(function (error) {
                console.log(error.stack);
                return null;
            });

        function setEdit(root, edit) {
            if (!edit) {
                root.querySelectorAll("[tag='input']").forEach(c => { c.style.display = "none"; });
                root.querySelectorAll("[tag='description']").forEach(c => { c.style.display = ""; });
                root.querySelectorAll("button[tag='toggle']").forEach(c => {
                    c.style.display = "none";
                    if ("false" === c.getAttribute("collapsed")) {
                        $trigger(c, 'click');
                    }
                });
            }
            else {
                root.querySelectorAll("[tag='input']").forEach(c => { c.style.display = ""; });
                root.querySelectorAll("[tag='description']").forEach(c => { c.style.display = "none"; });
                root.querySelectorAll("button[tag='toggle']").forEach(c => {
                    c.style.display = "";
                    if ("true" === c.getAttribute("collapsed")) {
                        $trigger(c, 'click');
                    }
                });
            }
        }

        function ready(editor) {
            editor.on('ready', function () {
                var buttonData = editor.root.getButton('', 'data', 'Data');
                button_holder = editor.root.editors.d.theme.getHeaderButtonHolder();
                button_holder.appendChild(buttonData);
                editor.root.editors.d.header.parentNode.appendChild(button_holder);
                buttonData.addEventListener('click', function (e) {
                    e.preventDefault();
                    editor.root.editors.d.container.hidden = true;
                }, false);

                var buttonEdit = editor.root.getButton('', 'edit', 'Edit');
                button_holder = editor.root.theme.getHeaderButtonHolder();
                button_holder.appendChild(buttonEdit);
                editor.root.header.parentNode.appendChild(button_holder);
                buttonEdit.addEventListener('click', function (e) {
                    e.preventDefault();

                    var root = editor.getEditor('root');
                    setEdit(root.container, root.schema.edit);
                    root.schema.edit = !root.schema.edit;
                }, false);

                //======================================================//
                //p hide
                var h4 = document.querySelectorAll("h4[tag='h4']");
                h4.forEach(c => {
                    //console.log(c.firstChild.innerHTML);
                    //var parent = c.parentNode;
                    ////parent.childNodes.forEach(c2=>c2.);
                    //if (null != parent.querySelector("p:only-child")) {
                    //    c.style.marginBottom = '6px';
                    //}

                    //var row = c.parentNode.parentNode;
                    //if (null == row || "row" != row.className) { return; }

                    //var pre = row.previousSibling;
                    //if (null == pre || "row" != pre.className) { return; }

                    //c.style.marginTop = '3px';
                    //var p = pre.querySelector("p[class='help-block']");
                    //if (null == p) {//if edit == false
                    //    c.style.marginTop = '0px';
                    //}

                    //c.style.marginBottom = '10px';
                    //c.parentNode.childNodes.forEach(c2 => {
                    //    //console.log(c2.tagName);
                    //    if ("P" == c2.tagName) {
                    //        c.style.marginBottom = '6px';
                    //    }
                    //});
                });

                document.querySelectorAll("div[tag='description']").forEach(c => {
                    var h5 = c.querySelectorAll("h5");
                    if (h5.length > 0) {

                    }
                });
                //
                document.querySelectorAll("div[tag='panel'] > div > div").forEach(c => {
                    var rows = c.querySelectorAll(".row");
                    if (rows.length > 0) {
                        //var form = rows[rows.length - 1].querySelector(".form-group");
                        //if (null != form) {
                        //    form.style.marginBottom = '3px';
                        //    var input = form.querySelector("[class='form-control']");
                        //    if (null != input) {
                        //        input.style.marginBottom = '10px';
                        //    }
                        //}

                        //var h4 = c.querySelectorAll("h4[name='h4']");
                        //if (1 == h4.length) {
                        //    //h4[0].style.marginTop = '9px';
                        //}
                    }
                });
            });
        }

        function getSdk(format) {
            return {
                type: "object",
                properties: {
                    value: {
                        type: "string",
                        format: format,
                        options: {
                            ace: {
                                theme: "ace/theme/vibrant_ink",
                                useWorker: false,
                                tabSize: 2,
                                readOnly: true,
                                highlightActiveLine: false,
                                highlightSelectedWord: false,
                                minLines: 20,
                                maxLines: 100
                            }
                        }
                    }
                },
                options: {
                    collapsed: false,
                    disable_collapse: true
                }
            };
        }

        function getData(editor, args) {
            for (var i = args.length - 1; i >= 0; i--) {
                args[i] = JSON.stringify(editor.getEditor(args[i]).getValue());
            }
            return JSON.stringify(args)
        }

        /*
        // Hook up the Restore to Default button
        document.getElementById('restore').addEventListener('click', function () {
            editor.setValue(starting_value);
        });

        // Hook up the validation indicator to update its
        // status whenever the editor changes
        editor.on('change', function () {
            // Get an array of errors from the validator
            var errors = editor.validate();

            var indicator = document.getElementById('valid_indicator');

            // Not valid
            if (errors.length) {
                indicator.className = 'label alert';
                indicator.textContent = 'not valid';
            }
            // Valid
            else {
                indicator.className = 'label success';
                indicator.textContent = 'valid';
            }
        });
        */


    </script>
</body>
</html>
